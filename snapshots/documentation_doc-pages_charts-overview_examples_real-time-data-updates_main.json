{
  "properties": [
    {
      "name": "options"
    }
  ],
  "externalEventHandlers": [],
  "instanceMethods": [
    "function updateData() {var now = Date.now();options.data = getData();}"
  ],
  "globals": [
    "var systemLoad = 0;",
    "var userLoad = 0;",
    "var data = [];",
    "var refreshRateInMilliseconds = 50;",
    "var millisecondsOfData = 30 * 1000;",
    "function calculateRandomDelta(maxChange) {return maxChange / 2 - Math.floor(Math.random() * Math.floor(maxChange + 1));}",
    "function ensureBounds(load, max) {if (load > max) {return max;} else if (load < 0) {return 0;}return load;}",
    "function calculateCpuUsage() {systemLoad = ensureBounds(systemLoad + calculateRandomDelta(2), 30);userLoad = ensureBounds(userLoad + calculateRandomDelta(4), 70);}",
    "function getData() {var dataCount = millisecondsOfData / refreshRateInMilliseconds;data.shift();var timeDelta = (dataCount - data.length - 1) * refreshRateInMilliseconds;var now = Date.now();while (data.length < dataCount) {calculateCpuUsage();data.push({time: now - timeDelta,system: systemLoad,user: userLoad});timeDelta -= refreshRateInMilliseconds;}return data;}"
  ],
  "init": ["setInterval(this.updateData, refreshRateInMilliseconds);"],
  "template": "$$CHART$$"
}
